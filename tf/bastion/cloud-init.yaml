#cloud-config
package_update: true
package_upgrade: true

packages:
  - gnupg
  - software-properties-common
  - curl
  - jq
  - yq
  - dnsutils
  - stow
  - fuse
  - libfuse2
  - nodejs
  - npm

runcmd:
  - curl -fsSL https://apt.releases.hashicorp.com/gpg | gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg
  - echo "deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main" > /etc/apt/sources.list.d/hashicorp.list
  - apt update
  - apt install -y terraform

  - mkdir -p /opt/nvim
  - curl -Lo /opt/nvim/nvim https://github.com/neovim/neovim/releases/latest/download/nvim-linux-x86_64.appimage
  - chmod +x /opt/nvim/nvim

  - su - admin -c 'echo "export PATH=\$PATH:/opt/nvim/" >> ~/.bashrc'
  - su - admin -c 'git clone https://github.com/mcmoodoo/dotfiles.git ~/dotfiles'
  - su - admin -c 'cd ~/dotfiles && stow nvim'
  - su - admin -c 'mkdir -p ~/repos/ledger && git clone https://github.com/mcmoodoo/ledger ~/repos/ledger'
  - su - admin -c 'echo "set -o vi" >> ~/.bashrc'
  - su - admin -c 'echo "alias ll='\''ls -al'\''" >> ~/.bashrc'
